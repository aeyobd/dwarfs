### A Pluto.jl notebook ###
# v0.19.36

using Markdown
using InteractiveUtils

# ╔═╡ 6e08e538-bc82-11ee-1a75-d97f506d18c5
begin
	import Pkg; Pkg.activate()

	using Plots; plotly()
	import LilGuys as lguys
end

# ╔═╡ 9104ed25-9bc8-4582-995b-37595b539281
out = lguys.Output("out")

# ╔═╡ 1949680f-da96-4a97-a1d3-73eb9a8dc428
begin 
	asya_fornax1_vmax_x = [-10.230335175684273, -9.972075577696813, -9.694814153881742, -9.289827413851505, -8.954321263043102, -8.566105699721582, -7.98035376442693, -7.4644955015242775, -6.863459488933502, -6.441205872390347, -5.848101056666749, -5.445097115853306, -4.944688163514843, -4.404210143670327, -3.8797597508282324, -3.37538520005618, -2.8509348072140854, -2.2484116952107147, -1.8492081195627925, -1.256681620277428, -0.7329747771416297, -0.2630513627613791, 0.3408762320205536, 0.7667649804611649]
	
	asya_fornax1_vmax_y = [39.788822260618176, 39.502433625820146, 38.97437634809319, 38.16512518209845, 37.590089327054464, 36.61279940373344, 36.04724960757078, 35.95216316021276, 35.80558096464185, 35.680455330826305, 35.481473952863325, 34.67945026030198, 34.08815259003286, 34.24467256157469, 34.082280267868235, 34.04139987126063, 33.897753836772026, 33.37466544703052, 32.859933823446376, 32.936951587220925, 32.75197343903513, 32.79962959198654, 32.67902112906687, 32.35265553184041]

	asya_fornax1_vhl_x = [-10.478035525587481, -10.09535550747245, -9.717455844613294, -9.401868531843876, -9.004931313842903, -8.585601905432831, -8.09163186232577, -7.594726513359834, -6.979150941813851, -6.4823294587296, -5.900635703383149, -5.522400576997266, -5.166473775138798, -4.694308861269058, -4.042000033546352, -3.4142639091564773, -2.7275700699441447, -2.11820057364263, -1.669014911353763, -1.259078481692077, -0.8091380264680712, -0.22576695348798204, 0.3419211996175715, 0.7413743940690054]
	asya_fornax1_vhl_y = [13.741380699674222, 13.779138703104675, 14.111593318675247, 14.372952376567014, 14.62086590152989, 15.03086256316983, 15.120192473724803, 15.065489415096295, 15.135295675096984, 15.18207876227423, 15.271408672829203, 15.628175758901335, 15.830411308982491, 15.79394260323015, 15.889166446027927, 15.985127030356054, 15.884930182228413, 16.18036353589888, 16.234145667614452, 16.256063728142376, 16.35736568856554, 16.35736568856554, 16.470823884239486, 16.439512369199598]

	asya_rho_dmi_x = [-0.9187524442706296, -0.7994860048047376, -0.688991005084083, -0.5664841611263199, -0.45872674451086654, -0.3383848259679312, -0.24515336052293424, -0.12267445108665288, -0.013646013743784569, 0.09876250069836304, 0.19237108218336219, 0.2974328174758366, 0.408276998715012, 0.5023185652829767, 0.5939856975250014, 0.693572266607073, 0.7862590088831778, 0.870286049499972, 0.9603190122353203, 1.0507570255321526, 1.1325074026481927, 1.2146209285434941, 1.2969858651321302]
	
	asya_rho_dmi_y = [8.38707562171112, 8.30733922394715, 8.18196423009459, 8.082097014803036, 7.938001016376781, 7.808593301749152, 7.671972590613269, 7.529024114358781, 7.368403796659071, 7.209521155390895, 7.0693267323486495, 6.861461287519877, 6.707529384764184, 6.511139161653087, 6.33124047146768, 6.121866854641727, 5.932165046474648, 5.72577498729529, 5.509483451090966, 5.296437763315355, 5.0865395649251655, 4.85792036196128, 4.637104309765414]
	
	asya_rho_dmf_x = [-0.8257165204760042, -0.7195374043242639, -0.6070031845354489, -0.50118721716297, -0.39855578523939883, -0.30419297167439524, -0.18668640706184703, -0.07730878820045813, 0.019679870383820325, 0.12267445108665288, 0.22400692776132744, 0.3256746186937818, 0.41333314710319013, 0.48903570031845356, 0.5707022738700486, 0.6463629253030896, 0.7210039667020504, 0.8051148108832895, 0.8892256550645288, 0.9836583049332365]
	asya_rho_dmf_y = [8.11744069769348, 7.969082474057802, 7.9067884133046995, 7.796691857510533, 7.686431369977541, 7.50725397944296, 7.370436550220488, 7.200275405321224, 7.026704480254422, 6.838740348518877, 6.626579892132916, 6.396157440041966, 6.141440304257307, 5.893214865330076, 5.578629858526909, 5.194177144636973, 4.817593154210587, 4.356125309421157, 3.9660661300634414, 3.587449386075638]

end

# ╔═╡ c5672da9-0dad-4d22-abe5-9e186ccde02d
begin
	snap_i = lguys.Snapshot("initial.hdf5")
	snap_f = out[4]
	prof_i = lguys.Profile(snap_i)
	prof_f = lguys.Profile(snap_f)
end

# ╔═╡ 0e89851e-763f-495b-b677-b664501a17ef
begin 
	scatter(log10.(prof_i.rs), prof_i.Vs_circ * lguys.V0)
	scatter!(log10.(prof_f.rs), prof_f.Vs_circ * lguys.V0)

	xlabel!("log r")
	ylabel!("V_circ")
end

# ╔═╡ 30f3a998-8c4b-4cc3-97d7-967537f9986f
begin 
	scatter(log10.(prof_i.rs), log10.(prof_i.ρs))
	scatter!(log10.(prof_f.rs), log10.(prof_f.ρs))
	xlabel!("log r / kpc")
	ylabel!("log rho / 1e10 Msun kpc^-3")

	scatter!(asya_rho_dmi_x, asya_rho_dmi_y .- 10)
end

# ╔═╡ 72dfab8a-c6c8-4dcc-b399-a0cf6cb0dea0
begin 
	histogram2d(log10.(lguys.calc_r(snap_i.positions)), lguys.calc_r(snap_i.velocities) * lguys.V0)
end

# ╔═╡ Cell order:
# ╠═6e08e538-bc82-11ee-1a75-d97f506d18c5
# ╠═9104ed25-9bc8-4582-995b-37595b539281
# ╟─1949680f-da96-4a97-a1d3-73eb9a8dc428
# ╠═c5672da9-0dad-4d22-abe5-9e186ccde02d
# ╠═0e89851e-763f-495b-b677-b664501a17ef
# ╠═30f3a998-8c4b-4cc3-97d7-967537f9986f
# ╠═72dfab8a-c6c8-4dcc-b399-a0cf6cb0dea0
